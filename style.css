/* =========================================
   1. GLOBAL RESET & APP STRUCTURE
   ========================================= */
html, body {
    height: 100%;
    overflow: hidden; /* Handle scrolling in .main-content */
    font-family: 'Inter', sans-serif;
    -webkit-tap-highlight-color: transparent;
}

:root {
    --tw-shadow: 0 0 #0000 !important;
    --tw-shadow-colored: 0 0 #0000 !important;
    
    /* Leaderboard Tokens */
    --radius: 24px;
    --gold: #D4AF37;
    --silver: #C0C0C0;
    --bronze: #CD7F32;
    --forest-accent: #1e8f4b;
    
    /* Christmas Palette (Dec 19 - Dec 26) */
    --xmas-gold: #FFD700;
    --xmas-red: #D42426;
    --xmas-green: #165B33;
}

*, *::before, *::after {
    box-shadow: none !important;
}
* {
  -webkit-user-select: none;
  -moz-user-select: none;
  user-select: none;
}

/* --- RESPONSIVE LAYOUT CONTAINER --- */
.app-container {
    width: 100%;
    height: 100%;
    display: flex;
    flex-direction: column; /* Mobile Default: Top Header, Content, Bottom Bar */
    position: relative;
    overflow: hidden;
    background-color: #f9fafb;
}
.dark .app-container {
    background-color: #111827;
}

/* Desktop Layout: Side-by-Side */
@media (min-width: 1024px) {
    .app-container {
        flex-direction: row;
    }
}

/* =========================================
   2. CUSTOM UTILITIES & COMPONENTS
   ========================================= */

/* Glassmorphism Cards */
.glass-card {
    background: rgba(255, 255, 255, 0.7);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid rgba(255, 255, 255, 0.5);
}
.dark .glass-card {
    background: rgba(31, 41, 55, 0.6);
    border: 1px solid rgba(255, 255, 255, 0.1);
}

.glass-green-card {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    box-shadow: 0 8px 32px 0 rgba(16, 185, 129, 0.25);
    border: 1px solid rgba(255, 255, 255, 0.18);
    border-radius: 1rem;
    position: relative;
    overflow: hidden;
}

/* Mobile Bottom Navigation */
.glass-bottom-bar {
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(16px);
    -webkit-backdrop-filter: blur(16px);
    padding-bottom: env(safe-area-inset-bottom);
}
.dark .glass-bottom-bar {
    background: rgba(17, 24, 39, 0.9);
}

/* Buttons */
.btn-eco-gradient {
    background: linear-gradient(135deg, #10b981 0%, #059669 100%);
    transition: all 0.2s ease;
}
.btn-eco-gradient:active {
    transform: scale(0.98);
    opacity: 0.9;
}

/* Navigation Items */
.nav-item.active {
    color: #16a34a; /* Green-600 */
    position: relative;
}
.nav-item.active::after {
    content: '';
    position: absolute;
    top: 0;
    left: 50%;
    transform: translateX(-50%);
    width: 24px;
    height: 3px;
    background-color: #16a34a;
    border-bottom-left-radius: 4px;
    border-bottom-right-radius: 4px;
}
.dark .nav-item.active {
    color: #4ade80; /* Green-400 */
}
.dark .nav-item.active::after {
    background-color: #4ade80;
}

/* Sidebar Styling */
.sidebar-nav-item.active {
    background-color: #f0fdf4; /* Green-50 */
    color: #15803d; /* Green-700 */
    font-weight: 700;
}
.dark .sidebar-nav-item.active {
    background-color: rgba(22, 163, 74, 0.2);
    color: #4ade80;
}

/* Forms */
.custom-select {
    appearance: none;
    background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='M6 8l4 4 4-4'/%3e%3c/svg%3e");
    background-position: right 0.5rem center;
    background-repeat: no-repeat;
    background-size: 1.5em 1.5em;
}

/* Utilities */
.no-scrollbar::-webkit-scrollbar {
    display: none;
}
.no-scrollbar {
    -ms-overflow-style: none;
    scrollbar-width: none;
}

.line-clamp-2 {
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

/* =========================================
   3. ANIMATIONS
   ========================================= */
@keyframes slideUp {
    from { transform: translateY(20px); opacity: 0; }
    to { transform: translateY(0); opacity: 1; }
}
.animate-slideUp {
    animation: slideUp 0.4s ease-out forwards;
}

@keyframes pulse-subtle {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.05); }
}
.points-pulse {
    animation: pulse-subtle 0.3s ease-in-out;
    color: #16a34a !important; 
}

/* Chatbot Floating Animation */
@keyframes float {
    0%, 100% { transform: translate(0, 0); }
    33% { transform: translate(15px, -20px); }
    66% { transform: translate(-10px, 10px); }
}
.animate-float {
    animation: float 12s infinite ease-in-out;
}

/* Breathing Effect for Cards */
@keyframes breathe {
    0%, 100% { transform: scale(1); }
    50% { transform: scale(1.01); }
}
.animate-breathe {
    animation: breathe 4s ease-in-out infinite;
}

/* =========================================
   4. PAGE TRANSITIONS & LEADERBOARD
   ========================================= */
.page {
    display: none;
    opacity: 0;
    transition: opacity 0.3s ease-in-out;
}
.page.active {
    display: block;
    opacity: 1;
    animation: fadeInPage 0.4s ease-out;
}
@keyframes fadeInPage {
    from { opacity: 0; transform: translateY(5px); }
    to { opacity: 1; transform: translateY(0); }
}

/* Leaderboard Specifics */
.podium-wrapper {
    display: flex;
    justify-content: center;
    align-items: flex-end;
    gap: 16px;
    margin-bottom: 32px;
    margin-top: 20px;
}
.champ {
    display: flex;
    flex-direction: column;
    align-items: center;
    position: relative;
    width: 90px;
    text-align: center;
}
.champ:nth-child(2) { margin-bottom: 30px; transform: scale(1.15); z-index: 10; } /* 1st Place */
.champ .avatar {
    width: 64px; height: 64px;
    border-radius: 50%;
    border: 3px solid white;
    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    object-fit: cover;
    margin-bottom: -12px;
    position: relative;
    z-index: 2;
}
.champ:nth-child(2) .avatar { border-color: var(--gold); }
.champ:nth-child(1) .avatar { border-color: var(--silver); }
.champ:nth-child(3) .avatar { border-color: var(--bronze); }

.champ .rank-badge {
    width: 24px; height: 24px;
    border-radius: 50%;
    display: flex; align-items: center; justify-content: center;
    font-size: 10px; font-weight: 800; color: white;
    position: relative; z-index: 3; margin-bottom: 8px;
    box-shadow: 0 2px 4px rgba(0,0,0,0.2);
}
.champ:nth-child(2) .rank-badge { background: var(--gold); }
.champ:nth-child(1) .rank-badge { background: var(--silver); }
.champ:nth-child(3) .rank-badge { background: var(--bronze); }

.champ .name { font-size: 12px; font-weight: 700; color: #374151; margin-bottom: 2px; }
.dark .champ .name { color: #e5e7eb; }
.champ .points { font-size: 11px; font-weight: 600; color: #10b981; }

.list .item {
    display: flex; align-items: center; justify-content: space-between;
    padding: 12px 16px;
    background: white;
    border: 1px solid #f3f4f6;
    margin-bottom: 10px;
    border-radius: 16px;
    box-shadow: 0 1px 2px rgba(0,0,0,0.02);
}
.dark .list .item {
    background: #1f2937;
    border-color: #374151;
}
.list .item.is-me {
    background: #ecfdf5;
    border: 1px solid #6ee7b7;
}
.dark .list .item.is-me {
    background: rgba(16, 185, 129, 0.1);
    border-color: #059669;
}

.list .user { display: flex; align-items: center; gap: 12px; }
.list .circle { width: 40px; height: 40px; border-radius: 50%; overflow: hidden; background: #e5e7eb; flex-shrink: 0; }
.list .user-info { display: flex; flex-direction: column; }
.list .user-info strong { font-size: 14px; color: #111827; }
.dark .list .user-info strong { color: white; }
.list .user-info .sub-class { font-size: 11px; color: #9ca3af; }
.list .points-display { font-weight: 700; color: #10b981; font-size: 14px; }

/* =========================================
   5. GALLERY / GREENLENS
   ========================================= */
.main-content {
    transition: background-color 0.7s cubic-bezier(0.4, 0, 0.2, 1);
    will-change: background-color;
}
#green-lens .main-content { /* JS handles bg */ }

/* Force White Text on Sidebar when background is dark (GreenLens) */
#sidebar.force-dark-text .sidebar-nav-item,
#sidebar.force-dark-text h2, 
#sidebar.force-dark-text p,
#sidebar.force-dark-text i {
    color: rgba(255, 255, 255, 0.9) !important;
}
#sidebar.force-dark-text .sidebar-nav-item:hover {
    background-color: rgba(255, 255, 255, 0.1) !important;
}
#sidebar.force-dark-text .sidebar-nav-item.active {
    background-color: rgba(255, 255, 255, 0.2) !important;
    color: #fff !important;
}

/* =========================================
   6. TOAST NOTIFICATIONS (Standard)
   ========================================= */
#app-toast {
    position: fixed;
    bottom: 90px; /* Above nav */
    left: 50%;
    transform: translateX(-50%);
    z-index: 110;
    
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    
    min-width: 280px;
    max-width: 90%;
    padding: 14px 20px;
    
    border-radius: 50px;
    font-family: 'Plus Jakarta Sans', sans-serif;
    font-size: 14px;
    font-weight: 600;
    color: white;
    
    box-shadow: 0 10px 25px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(8px);
    
    opacity: 0;
    animation: toastSlideUp 0.4s cubic-bezier(0.16, 1, 0.3, 1) forwards;
}

.toast-success { background: rgba(16, 185, 129, 0.95); border: 1px solid rgba(16, 185, 129, 1); }
.toast-error   { background: rgba(220, 38, 38, 0.95); border: 1px solid rgba(220, 38, 38, 1); }
.toast-warning { background: rgba(245, 158, 11, 0.95); border: 1px solid rgba(245, 158, 11, 1); }

@keyframes toastSlideUp {
    from { transform: translate(-50%, 20px); opacity: 0; }
    to { transform: translate(-50%, 0); opacity: 1; }
}

.toast-hiding {
    transition: all 0.3s ease;
    transform: translate(-50%, 20px) !important;
    opacity: 0 !important;
}

/* =========================================
   7. CHRISTMAS THEME (Dec 19 - Dec 26)
   ========================================= */

/* --- Snow Effect --- */
.snow-container {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    pointer-events: none; /* Passes touches through */
    z-index: 9999;
    overflow: hidden;
}

.snowflake {
    position: absolute;
    top: -10px;
    color: #fff;
    font-size: 1em;
    font-family: Arial, sans-serif;
    text-shadow: 0 0 5px #000;
    user-select: none;
    z-index: 9999;
    animation-name: fall;
    animation-timing-function: linear;
    animation-iteration-count: infinite;
}

/* Simple, lightweight fall animation */
@keyframes fall {
    0% { transform: translateY(-10vh) translateX(0px) rotate(0deg); opacity: 0.8; }
    100% { transform: translateY(110vh) translateX(20px) rotate(360deg); opacity: 0.3; }
}

/* --- Festive Toast --- */
.toast-christmas {
    background: linear-gradient(135deg, #D42426 0%, #B91C1C 100%);
    border: 1px solid #FCD34D; /* Gold border */
    color: #FFF;
}

/* Subtle glow pulse for festive toasts */
@keyframes festiveGlow {
    0%, 100% { box-shadow: 0 0 10px rgba(255, 215, 0, 0.3); }
    50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.6); }
}

.festive-toast-glow {
    animation: festiveGlow 2s infinite;
}

/* --- Festive Header Accents (Optional Helper) --- */
.festive-header-accent {
    border-bottom: 2px solid rgba(212, 175, 55, 0.3) !important; /* Subtle Gold */
}
